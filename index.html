<!DOCTYPE html>
<html lang="en">

    <head>
        <meta charset="UTF-8">
        <link rel="stylesheet" type="text/css" href="styles.css">
        <link rel="icon" href="media/TP.png">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
        <script src="https://betterdiscord.app/js/vendor/countUp.min.js?v=DBxeQBHNMaYkRvB8uPOLm07cbQj54TDexlykb-Dcg28"></script>
        <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
        <script src="js/funFact.js"></script>
        <script src="js/main.js"></script>
        <script src="js/searchBar.js"></script>
        <script src="js/profiles.js"></script>
        <title>SPT Leaderboard</title>
    </head>

    <body>
        <nav class="navbar animate__animated animate__fadeIn">
            <a href="#">
                <img src="media/TP.png" alt="SPT Leaderboard Logo" class="navbar-logo">
            </a>
            <div class="navbar-links">
                <a id="infoButton" class="navbar-link">How it works</a>
            </div>
            <div class="season-selector">
                <label for="seasonSelect">Season:</label>
                <select id="seasonSelect">
                </select>
            </div>
        </nav>
        <h1 style="margin-top: 80px;" class="animate__animated animate__fadeInDown">SPT Leaderboard</h1>
        <div id="welcomePopup">
            <div class="welcome-bg-image animate__animated animate__fadeIn">
                <img class="" src="media/TP.png" alt="SPT Leaderboard Preview">
            </div>
            <div class="popup-container">
                <div class="popup-content">
                    <h1 class="animate__animated animate__fadeInDown">Welcome to SPT Leaderboard!</h1>
                    <p class="animate__animated animate__fadeInUp">Track, progress and compare your Single Player Tarkov profile with other players, or compete with your friends!</p>
                    <p class="animate__animated animate__fadeInUp">Leaderboard updates are live! See how you rank against the community and set new personal records in your SPT experience!</p>
                    <button class="animate__animated animate__fadeInUp" id="continueBtn">Continue to Leaderboard</button>
                </div>
                <div class="popup-image animate__animated animate__fadeInUp">
                    <img class="" src="media/leaderboard_preview.png" alt="SPT Leaderboard Preview">
                </div>
            </div>
        </div>
        <div id="infoModal" class="modal">
            <div class="modal-content">
                <span class="close">&times;</span>
                <h2>Ranking System Explained</h2>
                <p>The leaderboard uses a weighted scoring system to calculate player performance across multiple metrics.</p>
                
                <h3>1. Leaderboard Terminology</h3>
                <ul>
                    <li><strong>KDR:</strong> Kill-to-Death Ratio (Kills √∑ Deaths)</li>
                </ul>

                <h3>2. Season System</h3>
                <p>Competitive cycles with unique leaderboards:</p>
                <ul>
                    <li><strong>Duration:</strong> 1-3 months per season</li>
                    <li><strong>Reset:</strong> New season automatically starts when SPT major version releases or SPT Leaderboard mod</li>
                    <li><strong>Hall of Fame:</strong> Top 3 players from previous season are shown permanently on the page</li>
                    <li><strong>Data:</strong> Full season archives and Global Leaderboard available in "Season" dropdown menu</li>
                </ul>

                <h3>3. Skill Formula</h3>
                <p>Final skill score is calculated using these weighted factors:</p>
                <ul>
                    <li><strong>KDR:</strong> 20% weight</li>
                    <li><strong>Survival Rate:</strong> 20% weight</li>
                    <li><strong>Total Raids:</strong> 50% weight</li>
                    <li><strong>PMC Level:</strong> 10% weight</li>
                    <li><strong>This includes calibration:</strong> 
                        <ul>
                            <li>Minimum 50 raids required for proper skill score ranking</li>
                            <li>70% skill score penalty until player reaches 50 raids</li>
                            <li>Penalty decreases linearly until player reaches 100 raids</li>
                        </ul>
                    </li>
                </ul>

                <h3>4. Skill Tiers</h3>
                <p>Players are classified into tiers based on final skill score:</p>
                <ul>
                    <li><strong>L- to L+:</strong> Low (0-18)</li>
                    <li><strong>M- to M+:</strong> Medium (18-21)</li>
                    <li><strong>H- to H+:</strong> High (21-25)</li>
                    <li><strong>P- to P+:</strong> Pro (25-32)</li>
                    <li><strong>G:</strong> God (32+)</li>
                </ul>

                <h3>5. Visual Indicators</h3>
                <p>Statistics are color-coded based on performance thresholds:</p>
                <ul>
                    <li><strong>Survival Rate:</strong>
                        <span class="bad">Bad</span> (<30%),
                        <span class="average">Average</span> (30-54%),
                        <span class="good">Good</span> (55-64%),
                        <span class="impressive">Impressive</span> (65%+)
                    </li>
                    <li><strong>KDR:</strong>
                        <span class="bad">Poor</span> (<5),
                        <span class="average">Standard</span> (5-12),
                        <span class="good">Skilled</span> (12-14.99),
                        <span class="impressive">Impressive</span> (15+)
                    </li>
                    <li><strong>Raid Duration:</strong>
                        <span class="bad">Short</span> (<5m),
                        <span class="average">Average</span> (5-15m),
                        <span class="good">Long</span> (15-20m),
                        <span class="impressive">Impressive</span> (20m+)
                    </li>
                </ul>
            </div>
        </div>

        <!--
        <div id="updateAnnouncement" class="animate animate__animated animate__fadeIn">
            <button id="closeAnnouncement" class="close-btn">√ó</button>
            <h2>Season 2 is coming to an end</h2>
            <p>As of right now, the SPT Leaderboard mod and its backend is getting actively updated.</p>
                <p>Season 2 will be immortalized forever, our winners chosen, code polished, and new season started.</p>
            <p>Almost there. Just around the corner.</p>
            <div class="update-signature">‚Äî Developer</div>
        </div>
        -->
        <div class="stats-container animate animate__animated animate__fadeIn">
            <h2>Overall Statistics</h2>
            <p class="update-info">Random Quote/Fact: <span id="highlight"></span></p>
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-value" id="totalDeaths">0</div>
                    <div class="stat-label">üíÄ Total Deaths</div>
                </div>
                <!-- Not used for now
                <div class="stat-card">
                    <div class="stat-value" id="totalDeathsFromTP">0</div>
                <div class="stat-label">üíÄ Total Deaths by Twitch Players</div>
                </div>
                -->
                <div class="stat-card">
                    <div class="stat-value" id="totalRaids">0</div>
                    <div class="stat-label">üéÆ Total Raids</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="totalKills">0</div>
                    <div class="stat-label">‚öîÔ∏è Total Kills</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="totalDamage">0</div>
                    <div class="stat-label">üéØ Total Damage*</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="averageKDR">0.00</div>
                    <div class="stat-label">‚öîÔ∏è Average K/D Ratio</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="averageSurvival">0%</div>
                    <div class="stat-label">üõ°Ô∏è Average Survival Rate</div>
                </div>
            </div>
        </div>
        <div id="winners" class="animate animate__animated animate__fadeIn">
            <h2>Our previous season Champions!</h2>
        <div class="winners-container">
                <div class="winner-card">
                    <p class="winner-name">ü•à muertenis</p>
                    <p class="winner-rank">Second place</p>
                    <p class="winner-skill">Skill score: 29.68</p>
                    <p class="winner-stats">Raids: 203 | KDR: 22.45</p>
                </div>
            
                <div class="winner-card">
                    <p class="winner-name">ü•á Zetnork</p>
                    <p class="winner-rank">üëë First place üëë</p>
                    <p class="winner-skill">Skill score: 30.11</p>
                    <p class="winner-stats">Raids: 120 | KDR: 32</p>
                </div>
            
                <div class="winner-card">
                    <p class="winner-name">ü•â DiSir</p>
                    <p class="winner-rank">Third place</p>
                    <p class="winner-skill">Skill score: 28.40</p>
                    <p class="winner-stats">Raids: 131 | KDR: 18.29</p>
                </div>
            </div></div>
        <p id="status"></p>
        <div class="search-container">
            <input type="text" id="playerSearch" placeholder="Find player..." />
            <button id="clearSearch">Clear</button>
        </div>
        <table id="leaderboardTable" class="animate animate__animated animate__fadeIn">
            <thead>
                <tr>
                    <th data-sort="rank">Rank</th>
                    <th data-sort="name">Name</th>
                    <th data-sort="lastPlayed">Last Raid</th>
                    <th>Profile</th>
                    <th>Standing</th>
                    <th data-sort="totalRaids">Raids</th>
                    <th data-sort="survivedToDiedRatio">Survival Rate</th>
                    <th data-sort="killToDeathRatio">KDR</th>
                    <th data-sort="averageLifeTime">AVG Life Time</th>
                    <th data-sort="totalScore">Skill</th>
                    <!--
                        <th>TP</th>
                        <th>Fika</th>
                    -->
                    <th>SPT</th>
                </tr>
            </thead>
            <tbody>
            </tbody>
        </table>
        <div class="notification-container">
            <div id="loadingNotification" class="animate animate__animated animate__fadeInUp" style="display: none;">Loading Players...</div>
            <div id="emptyLeaderboardNotification" class="animate animate__animated animate__fadeInUp" style="display: none;">Whoops! Looks like leaderboard is empty. Be the first one to submit your stats!</div>
        </div>
        <div id="playerProfileModal" class="profile-modal">
            <div class="profile-modal-overlay"></div>
            <div class="profile-modal-container">
              <span class="profile-close-btn">&times;</span>
              <div id="modalPlayerInfo" class="profile-modal-content"></div>
            </div>
          </div>
    </body>
</html>